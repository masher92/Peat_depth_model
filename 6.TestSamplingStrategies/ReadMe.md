## Assessing impact of depth sampling strategy on model accuracy 
Samples containing points in the following formations are created (and in the following scripts):

* Regular grid (RegularGrid.R)
* Regular grid with short distance subset (RegularGrid_Sr.R)
* Spatial Coverage sample (SPCosa.R)
* Spatial coverage sample with short distance subset (SPCosa_sr.R)

Examples of each are displayed in Figure 1.
<p align="center">
<img src="Figs/RegularGrid_100m.png" width="240"  />  
  <img src="Figs/RegularGrid_sr_100m.png" width="240"  />  
   <img src="Figs/SPCosa_sr_100m.png" width="240"  />  
     <img src="Figs/SPCosa_100m.png" width="240"  />  
<p align="center"> Figure 1. Regular grid (1), regular grid with short distance subset (2), spatial coverage sample (3) and spatial coverage sample with short distance subset (4) <p align="center">

In each case, samples of various sizes (i.e. various numbers of sample points) are defined. Regular grids with spacings of 100m, 150m, 200m and 250m are created and the spatial coverage samples are designed to have sample numbers of equivalent sizes to the number in each of these. 

Collecting manual depth samples using all of these strategies, and various sample sizes, would require an unfeasible amount of time and labour, and so instead, synthetic depths are generated programmatically (using function defined in CreateSyntheticSample_functions.R).  
Both linear and geostatistical model performance is then assessed through cross-validation using these synthetic peat depth datasets.

The purpose of this part of the work is to assess whether model accuracy is influenced by the sampling strategy used. However, model accuracy could be influenced by the exact locations where the synthetic sample points happen to fall (e.g. if, by chance, a sample included lots of points in deep peat then performance of the model might be improved). In order to account for this, 50 variations of each sample configuration and sample size are generated and used in model cross-validation.

### Using R to define sample locations
#### Regular grid
A rectangular area bounding the study area is defined and then the "spsample" function from the "sp" package is used to create a grid of points over this area. This function takes as an input a number defining the distance between the points in the grid. Grids were created over the bounding box of the study area and subsequently trimmed to the boundary of the study area. Fifty variations of the grid formation were generated by randomly perturbing the grid's longitude and latitude by increments of 5m, corresponding to the topographic data's resolution.

#### Spatial coverage sample
Spatial coverage smaples are created using the "stratify" function, in the package "spcosa." The package uses the k-means clustering algorithm to split the study region into N equally spaced sub-regions, with one sample positioned randomly in each sub-region. Values of N were chosen to match the sample numbers associated with the regular grids being tested. The algorithm was run fifty times, with a different sub-region delineation generated each time.   
NB: Literature suggests this should be the centroid of each sub-area; however, this does not seem to be what is happening. 

#### Ading short distance subsets
Regular grids and spatial coverage samples are defined with the methods outlined above, and  subsequently the method outlined in Figure 1, adapted from [Haskard (2007)](#haskard2007), is used to supplement them with a short-range subset. A small subset of the original points is selected randomly, and then these are used to base short distance clusters around. Here, 10% of the total sample allowance is used in the short-distance subset, as recommended by [Lark and Marchant (2018)](#larkandmarchant2018) . This proportion was deemed reasonable to avoid the risk of short-range samples falling in unusual conditions. Concurrently, 10% of the original sample points are removed to ensure a consistent sample size for comparison between methods. For each point in the short distance subset, a buffer of 30m is created around the point. The dataframe of all points within the area of interest at 5m intervals (created from the slope and elevation files) is then searched to identify all points within the buffer. For each cluster, 3 of these points are then randomly selected and added to the spatial points dataframe. 

<p align="center">
<img src="Figs/200M_SR4.png" width="500"  />  
<p align="center"> Figure 1. Process for addition of short-distance subset. <p align="center">

##### Assigning synthetic depth values
<p align="center">
<img src="Figs/synthetic_data_flow2.PNG" width="500"  />  
<p align="center"> Figure 1. Slope (left) and elevation (right) profiles over the study area <p align="center">
  
  
### References
<a name="haskard2007"></a>
Haskard, K. A. (2007). An anisotropic Matern spatial covariance model: REML estimation and properties. PhD thesis, University of Adelaide.v
<a name="larkandmarchant2018"></a>
Lark, R. and Marchant, B. (2018). How should a spatial-coverage sample design for a geostatistical soil survey be supplemented to support estimation of spatial covariance parameters? Geoderma, 319:89-99.
